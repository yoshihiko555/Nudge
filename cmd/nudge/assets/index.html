<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nudge</title>
    <link rel="stylesheet" href="/styles.css" />
    <script type="module" src="/runtime.js"></script>
    <script type="module" src="/app.js"></script>
  </head>
  <body>
    <div id="app" data-mode="main" data-view="">
      <header class="app-header">
        <div class="title-block">
          <div class="logo">N</div>
          <div>
            <h1>Nudge</h1>
            <p class="subtitle">静かに表示</p>
          </div>
        </div>
        <div class="header-actions">
          <div class="status-chip" id="statusChip">未接続</div>
          <button class="icon-btn" id="openSettingsBtn" type="button" aria-label="設定を開く" title="設定を開く">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M12 9.2a2.8 2.8 0 1 0 0 5.6 2.8 2.8 0 0 0 0-5.6zm8.1 2.8-.9-.3a6.9 6.9 0 0 0-.6-1.4l.5-.8a.9.9 0 0 0-.1-1.1l-1-1a.9.9 0 0 0-1.1-.1l-.8.5c-.4-.2-.9-.4-1.4-.6l-.3-.9a.9.9 0 0 0-.9-.6h-1.4a.9.9 0 0 0-.9.6l-.3.9c-.5.1-1 .3-1.4.6l-.8-.5a.9.9 0 0 0-1.1.1l-1 1a.9.9 0 0 0-.1 1.1l.5.8c-.2.4-.4.9-.6 1.4l-.9.3a.9.9 0 0 0-.6.9v1.4c0 .4.3.8.6.9l.9.3c.1.5.3 1 .6 1.4l-.5.8a.9.9 0 0 0 .1 1.1l1 1a.9.9 0 0 0 1.1.1l.8-.5c.4.2.9.4 1.4.6l.3.9c.1.4.5.6.9.6h1.4c.4 0 .8-.2.9-.6l.3-.9c.5-.1 1-.3 1.4-.6l.8.5a.9.9 0 0 0 1.1-.1l1-1a.9.9 0 0 0 .1-1.1l-.5-.8c.2-.4.4-.9.6-1.4l.9-.3c.4-.1.6-.5.6-.9v-1.4c0-.4-.2-.8-.6-.9z"
                fill="none"
                stroke="currentColor"
                stroke-width="1.6"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
      </header>

      <nav class="tabs" id="tabNav"></nav>

      <div id="paneContainer">
        <section class="pane" data-pane="settings">
          <div class="pane-header">
            <div>
              <h2>設定</h2>
              <p class="hint">Notion 環境に合わせて入力</p>
            </div>
            <button class="btn" id="saveConfigBtn">保存</button>
          </div>

          <div class="form-block">
            <label>Notion API トークン</label>
            <input type="password" id="tokenInput" placeholder="secret_..." />
            <div class="row">
              <button class="btn ghost" id="saveTokenBtn">保存</button>
              <button class="btn danger" id="clearTokenBtn">削除</button>
            </div>
            <p class="hint" id="tokenHint">未保存</p>
          </div>

          <div class="form-block">
            <label>ログイン時に起動</label>
            <div class="toggle-row">
              <input type="checkbox" id="launchAtLoginInput" />
              <span class="toggle-text">macOSのログイン項目に追加します</span>
            </div>
          </div>

          <div class="section-block">
            <div class="section-header">
              <h3>データベース</h3>
              <button class="btn ghost" id="addDatabaseBtn">追加</button>
            </div>
            <div id="databaseList" class="database-list"></div>
          </div>

          <div class="form-block">
            <label>Notion Version</label>
            <input type="text" id="notionVersionInput" placeholder="YYYY-MM-DD" />
          </div>
        </section>
      </div>

      <template id="databaseCardTemplate">
        <div class="database-card">
          <div class="database-header">
            <div class="database-title">
              <input type="text" class="db-name-input" placeholder="タブ名" />
              <span class="db-key"></span>
            </div>
            <div class="database-controls">
              <select class="db-kind-select">
                <option value="task">タスク</option>
                <option value="habit">習慣</option>
              </select>
              <label class="toggle-row">
                <input type="checkbox" class="db-enabled-toggle" />
                <span>有効</span>
              </label>
              <button class="btn danger db-delete-btn" type="button">削除</button>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-block">
              <label>Database ID</label>
              <input type="text" class="db-database-id" placeholder="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />
              <div class="row">
                <button class="btn ghost db-resolve-data-source" type="button">Data Source ID 自動取得</button>
                <button class="btn ghost db-resolve-title" type="button">Title プロパティ自動検出</button>
              </div>
            </div>
            <div class="form-block">
              <label>Data Source ID</label>
              <input type="text" class="db-data-source-id" placeholder="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />
            </div>
            <div class="form-block">
              <label>Title プロパティ名</label>
              <input type="text" class="db-title-property" placeholder="Name" />
            </div>

            <div class="db-fields" data-kind="task">
              <div class="form-block">
                <label>Status プロパティ名</label>
                <input type="text" class="db-status-property" placeholder="Status" />
              </div>
              <div class="form-block">
                <label>Status 型</label>
                <select class="db-status-type">
                  <option value="status">status</option>
                  <option value="select">select</option>
                </select>
              </div>
              <div class="form-block">
                <label>進行中の値</label>
                <input type="text" class="db-status-in-progress" placeholder="In Progress" />
              </div>
              <div class="form-block">
                <label>完了の値</label>
                <input type="text" class="db-status-done" placeholder="Done" />
              </div>
              <div class="form-block">
                <label>中断の値</label>
                <input type="text" class="db-status-paused" placeholder="Paused" />
              </div>
            </div>

            <div class="db-fields" data-kind="habit">
              <div class="form-block">
                <label>曜日チェック列（自動）</label>
                <input type="text" class="db-checkbox-property" placeholder="日,月,火,水,木,金,土" readonly />
              </div>
            </div>
          </div>
        </div>
      </template>

      <footer class="footer">
        <div id="lastUpdated">未更新</div>
        <div id="errorText"></div>
      </footer>
    </div>
  </body>
</html>
